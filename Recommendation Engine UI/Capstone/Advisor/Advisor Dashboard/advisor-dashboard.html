<!DOCTYPE html>
<html lang='en-US'>
<head>
<title>Virtual Academic Advisor Advisor Dashboard Page</title>
<meta charset='UTF-8' >
<meta name='viewport' content='width=device-width, initial-scale=1.0'>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
<link rel='stylesheet' href='../styles.css'>
<link rel='stylesheet' href='advisor-dashboard.css'>

<script src='../jquery-3.2.1.js'></script>
<script src='advisor-dashboard.js'></script>

<style>
#headings { 
  font-size: 2em;
  font-weight: bold;
  margin-left: 6.75em; 
  margin-top: 3em;
}

#dropdownbox {
  display: inline-block;
  font-size: 1em;
  margin-left: 13.5em;
  margin-bottom: 1em;
  position: relative;
  width: 80%;
}

.dropdownbutton {
  background-color: rgb(184, 0, 0);
  color: white;
  margin-left: 1em;
  padding: 0.5em 2em;
  border: none;
  cursor: pointer;
  outline: none;
}

.dropdownbutton:hover, .dropdownbutton:focus {
  background-color: rgb(114, 0, 0);
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: rgb(210, 210, 210);
  overflow: auto;
  box-shadow: 0 0.5em 1em 0 rgba(0,0,0,0.2);
  z-index: 1;
  width: auto;
}

#request-type-item {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

#request-type-item li{
  border-bottom: 0.1em solid rgb(130, 130, 130);
}

#request-type-item li:last-child{
  border-bottom: none;
}

#request-type-item a {
  padding: 0.5em 1em;
  text-decoration: none;
  display: block;
  color: black;
}

#request-type-item a:hover {
  background-color: rgb(184, 0, 0);
  color: white;
}

#sort-drop-down {
  display: none;
  margin-left: 5.55em;
}

#sort-type-item {
  list-style-type: none;
  padding: 0;
  margin: 0;
}

#sort-type-item li{
  border-bottom: 0.1em solid rgb(130, 130, 130);
}

#sort-type-item li:last-child{
  border-bottom: none;
}

#sort-type-item a {
  padding: 0.5em 1em;
  text-decoration: none;
  display: block;
  color: black;
}

#sort-type-item a:hover {
  background-color: rgb(184, 0, 0);
  color: white;
}

.sort-button {
  font-size: 1em;
  padding: 0.5em 1em;
  text-align: center;
  display: inline-block;
  transition-duration: 0.4s;
  cursor: pointer;
  outline: none;
  margin: 1em 1em;
  border-style: outset solid;
  border-color: rgb(184, 0, 0);
  border-width: 0.2em;
  border-radius: 0.5em;
  background-color: white;
  box-shadow: 0 0.5em 1em 0 rgba(0,0,0,0.21),0 0.7em 3em 0 rgba(0,0,0,0.19);
}

.sort-button:hover {
  background-color: rgb(184, 0, 0);
  color: white;
}

.sort-button:active {
  transform: translateY(0.2em);
  box-shadow: 0 0.1em 1em 0 rgba(0,0,0,0.21),0 0.3em 3em 0 rgba(0,0,0,0.19);
}

#advance-button {
  font-size: 1em;
  cursor: pointer;
  border: none;
  outline: none;
  background-color: white;
  color: rgb(184, 0, 0);
}

.refresh {
  position: absolute;
  top: 0.5em;
  right: 0.5em;
  color: rgb(184, 0, 0);
}

.studentlist-heading {
  list-style-type: none;
  height: 1.5em;
  margin: 0 0 1em 0;
  padding: 0;
  border-bottom: 0.1em solid rgb(150, 150, 150);
}

.studentlist-heading li {
  float: left;
  width: 12%;
  padding: 0 1em;
  text-align: left;
}

.studentlist-heading li:nth-child(3) {
  width: 20%;
  text-align: left;
}

.studentlist-heading li:nth-child(4) {
  width: 37%;
}

.studentlist-heading li:last-child {
  width: 18%;
}

.studentrow {
  list-style-type: none;
  height: 3em;
  line-height: 1em;
  margin: 0;
  padding: 0;
  margin-bottom: 1em;
  border: 0.1em solid rgb(150, 150, 150);
  background-color: rgb(200, 200, 200);
  overflow: hidden;
}

.studentrow:hover {
  background-color: rgb(170, 170, 170);
}

.studentrow li {
  float: left;
  width: 12%;
  padding: 1em 1em;
  overflow: hidden;
  white-space: nowrap;
  text-align: left;
}

.studentrow li:nth-child(3) {
  width: 20%;
  text-align: left;
}

.studentrow li:nth-child(4) {
  width: 37%;
}

.studentrow li a {
  color: rgb(184, 0, 0);
}

.studentrow li:last-child {
  width: 18%;
  text-align: center;
}
</style>
</head>
<body>
<div class='container'>

  <div class='header clearfix'>
    <div class='toplink'>
      <ul>
	    <li><a id='account' href='../account.html'>Hello, Test Advisor!</a></li>
		<li><a id='help' href='../help.html'>Help</a></li>
        <li><a id='logout' href='../logout.html'>Log Out</a></li>
      </ul>
    </div>
    <h1>EVERETT</h1>
    <h3>COMMUNITY COLLEGE</h3>
  </div>
  
  <div class='nav clearfix'>
    <ul>
      <li><a id='advisordashboard' href='advisor-dashboard.html'>Advisor Dashboard</a></li>
	  <li><a id='advisestudent' href='../Advise%20Student/advise-student.html'>Advise Student</a></li>
	  <li><a id='exploreplans' href='#'>Explore Plans</a></li>
	  <li><a id='sitesetting' href='#'>Site Setting</a></li>
    </ul>
  </div>
  
  <div class='main clearfix'>
    <div class='heading'>
      <h1 id='mainheader'>Dashboard</h1>
      <h5 id='path'>Dashboard</h5>
	</div>
	<h2 id='headings'>Current & Recent Approval Requests</h2>
	<div id='dropdownbox'>
	  <label><b>Sort by:</b></label>
	  <button id='request-drop-down' class='dropdownbutton' name='request-type'>Select a request type</button>
	  <div id='request-dropdown-content' class='dropdown-content' style='top:3.2em;left:4.65em;'>
	    <ul id='request-type-item'>
		  <li><a id='pending-request' href='#'>Pending Request</a></li>
		  <li><a id='ip-request' href='#'>In Progress Request</a></li>
		  <li><a id='completed-request' href='#'>Completed Request</a></li>
		</ul>
      </div>
	  
	  <button class='sort-button'>Set</button>
	  <button id='advance-button'>Advance Sorting</button>
	  
	  <button id='sort-drop-down' class='dropdownbutton' name='sort-type'>Select a sort type</button>
	  <div id='sort-dropdown-content' class='dropdown-content' style='top:6.3em;left:4.65em;'>
	    <ul id='sort-type-item'>
		  <li><a id='sort-student-id' href='#'>Student ID</a></li>
		  <li><a id='sort-student-name' href='#'>Student Name</a></li>
		  <li><a id='sort-approved-date' href='#'>Approved Date</a></li>
		</ul>
      </div>
	</div>
	<div class='degreeplanblock' style='position:relative; margin-bottom: 1em;'>
	  <i class="refresh fa fa-refresh fa-spin"></i>
	  <ul class='studentlist-heading'>
	    <li>Status</li>
		<li>Student ID</li>
		<li>Student Name</li>
		<li>Active Plan Name</li>
		<li>Last Approved Date</li>
      </ul>
	  <div id='studentlist'>
	    <!--
	    Uncomment all the <ul class='studentrow'> if testing locally without connected to the backend (i.e. not making AJAX calls)
	    Comment these codes if testing locally and connected to the backend (i.e. making AJAX calls)
	    -->
	    <ul class='studentrow'>
	      <li style='color: orange;'>In Progress</li>
		  <li>0035689</li>
		  <li>Jaime Lannister</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  University of Washington Bothell - Computer Science</a></li>
		  <li>-</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: red;'>Pending</li>
		  <li>0058964</li>
		  <li>Cersei Lannister</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  University of Washington Bothell - Interactive Media Design</a></li>
		  <li>-</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: red;'>Pending</li>
		  <li>0047562</li>
		  <li>Jon Snow</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  University of Washington Bothell - Business Administration</a></li>
		  <li>-</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: red;'>Pending</li>
		  <li>0097621</li>
		  <li>Daenerys Targaryen</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  University of Washington Seattle - Astronomy</a></li>
		  <li>-</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: green;'>Completed</li>
		  <li>0014689</li>
		  <li>Sansa Stark</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  University of Washington Seattle - Dance</a></li>
		  <li>11/07/2017 5:23PM</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: green;'>Completed</li>
		  <li>0065498</li>
		  <li>Bran Stark</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  Washington State University - Education</a></li>
		  <li>11/06/2017 3:45PM</li>
        </ul>	
		<ul class='studentrow'>
	      <li style='color: green;'>Completed</li>
		  <li>0097654</li>
		  <li>Tyrion Lannister</li>
		  <li><a class='advise-degree-plan' href='Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html'>
		  Washington State University - Physical and Mathematical Sciences</a></li>
		  <li>11/04/2017 2:12PM</li>
        </ul>
      </div>		
	</div>
  </div>

  <div class='footer'>
    <p>&#169;Everett Community College</p>
  </div>

</div>
<script>
var productionURL = 'http://localhost:5000/';
var studentList = [];
$(document).ready(function() {
    //comment this line when testing while connected to backend
    vaaDashBuildArray();
    /*
	Uncomment these codes if testing locally and connected to the backend (i.e. making AJAX calls)
	Comment these codes if testing locally without connected to the backend (i.e. not making AJAX calls)
	vaaDashBuildStudentList();
	
	$('.advise-degree-plan').click(function() {
	    var ajaxStatusObject = JSON.parse(sessionStorage.getItem('recentAjaxStatusProperties'));
	    var sessionAjaxStatusObject = JSON.parse(sessionStorage.getItem('sessionAjaxStatusProperties'));
		var studentID = $(this).siblings().eq(1);
		var studentProperties = 'retrieveSID' + studentID + 'ActivePlanReady';
		
		if (sessionAjaxStatusObject[studentProperties] == undefined ) {
		    ajaxStatusObject[studentProperties] = '0';
		    sessionAjaxStatusObject[studentProperties] = '0';
		    sessionStorage.setItem('recentAjaxStatusProperties', JSON.stringify(ajaxStatusObject));
		    sessionStorage.setItem('sessionAjaxStatusProperties', JSON.stringify(sessionAjaxStatusObject));
		
		    sessionStorage.setItem('nextWebPage', 'Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html');
	        apiURL = productionURL + 'api/Vsa/';
		    apiURL += studentID;
		    //apiURL += $(this).parent('.studentrow').children().eq(1).text();
		    console.log(apiURL);
		    $.ajax({
		        url: apiURL,
		        type: 'GET',
		        dataType: 'json',
		        success: function(jsonText) {
			        //only checking if array of objects (JSON) was passed successfully
			        console.log('This is student's active plan info: ' + jsonText);
				    sessionStorage.setItem('sid' + studentID + 'ActivePlan', JSON.stringify(jsonText));
				    ajaxStatusObject[studentProperties] = '1';  //1 means successfully retrieved
				    //saving it locally
				    sessionStorage.setItem('recentAjaxStatusProperties', JSON.stringify(ajaxStatusObject));
		        },
		        error: function() {
		            console.log('AJAX failed');
		        }
		    })
		    location.href = 'loading.html';  // redirect to loading page
		} else if (sessionAjaxStatusObject[studentID] == '0') {
		    console.log('this should not be triggered');
		} else if (sessionAjaxStatusObject[studentID] == '1') {
		    location.href = 'Advise%20Student%20Active%20Degree%20Plan/advise-degree-plans.html';  // redirect to loading page
		}
	});
	$('#account').click(function() {});
	$('#help').click(function() {});
	$('#logout').click(function() {});
	$('#advisordashboard').click(function() {
	    sessionStorage.setItem('studentListArray', JSON.stringify(studentList));
	}); //for update information on this page only
	$('#advisestudent').click(function() {
	    
	});
	$('#exploreplans').click(function() {});
	$('#sitesetting').click(function() {});
	*/
    $('#dropdownbox').on('click', '#request-drop-down', function() {
	    $(this).siblings('#request-dropdown-content').css('display', 'block');
	});
	$('#dropdownbox').on('click', '#sort-drop-down', function() {
	    $(this).siblings('#sort-dropdown-content').css('display', 'block');
	});
	
	$('#dropdownbox').on('click', '#request-dropdown-content a', function(eventObject) {
	    eventObject.preventDefault();
	    $(this).parents('#request-dropdown-content').css('display', 'none');
		$(this).parents('#request-dropdown-content').prev('#request-drop-down').text($(this).text());
	    $('#studentlist').empty();
		vaaDashSortArray('Status', $(this).text());
	    vaaDashBuildStudentList();
	});
	$('#dropdownbox').on('click', '#sort-dropdown-content a', function(eventObject) {
	    eventObject.preventDefault();
	    $(this).parents('#sort-dropdown-content').css('display', 'none');
		$(this).parents('#sort-dropdown-content').prev('#sort-drop-down').text($(this).text());
		$('#studentlist').empty();
		vaaDashSortArray($(this).text(), 0);
		vaaDashBuildStudentList();
	});
	
	$(document).on('click', function(event) {
	    if (!(event.target.matches('.dropdownbutton'))) {
		    $('.dropdown-content').css('display', 'none');
		}
	});
	
	$('#dropdownbox').on('click', '#advance-button', function() {
	    if ($(this).siblings('#sort-drop-down').css('display') == 'none') {
		    $(this).siblings('#sort-drop-down').css('display', 'block');
			$(this).text('Normal Sorting');
		} else if ($(this).siblings('#sort-drop-down').css('display') == 'block') {
		    $(this).siblings('#sort-drop-down').css('display', 'none');
			$(this).text('Advance Sorting');
			$(this).siblings('#sort-drop-down').text('Select a sort type');
		}
	});
});
</script>
</body>
</html>